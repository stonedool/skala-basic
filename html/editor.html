<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Selection / Range Editor</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }

    .toolbar button {
      margin-right: 5px;
    }

    .editor {
      border: 1px solid #ccc;
      padding: 10px;
      min-height: 150px;
      margin-top: 10px;
    }

    .result {
      margin-top: 20px;
      background: #f5f5f5;
      padding: 10px;
      border: 1px solid #ccc;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>

<h2>Selection / Range 웹 에디터</h2>

<div class="toolbar">
  <button onclick="wrapSelection('b')">굵게</button>
  <button onclick="wrapSelection('i')">기울임</button>
  <button onclick="wrapSelection('u')">밑줄</button>
  <input type="color" onchange="applyColor(this.value)">
  <button onclick="save()">저장</button>
</div>

<div id="editor" class="editor" contenteditable="true">
  텍스트를 선택하고 스타일을 적용해보세요.
</div>

<h3>저장된 HTML</h3>
<div id="result" class="result"></div>

<script>
  function getRange() {
    const selection = window.getSelection();
    if (!selection || selection.rangeCount === 0) return null;
    return selection.getRangeAt(0);
  }

  function wrapSelection(tagName) {
    const range = getRange();
    if (!range || range.collapsed) return;

    const wrapper = document.createElement(tagName);
    wrapper.appendChild(range.extractContents());
    range.insertNode(wrapper);

    // 선택 해제
    window.getSelection().removeAllRanges();
  }

  function applyColor(color) {
    const range = getRange();
    if (!range || range.collapsed) return;

    const span = document.createElement('span');
    span.style.color = color;
    span.appendChild(range.extractContents());
    range.insertNode(span);

    window.getSelection().removeAllRanges();
  }

  function save() {
    const html = document.getElementById('editor').innerHTML;
    document.getElementById('result').textContent = html;
  }
</script>

</body>
</html>
